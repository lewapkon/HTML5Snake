{"ts":1370791813440,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"snake.input = (function() {\n\tvar dom = snake.dom,\n\t\t$ = dom.$,\n\t\tsettings = snake.settings,\n\t\tinputHandlers,\n\t\tkeys = {\n\t\t\t37 : \"KEY_LEFT\",\n\t\t\t38 : \"KEY_UP\",\n\t\t\t39 : \"KEY_RIGHT\"\n\t\t};\n\tfunction handleClick(event, control, click) {\n\t\tvar action = settings.controls[control];\n\t\tif (!action) {\n\t\t\t\treturn;\n\t\t}\n\t\tvar board = $(\"#game-screen .game-board\")[0],\n\t\t\tdirection,\n\t\t\trect = board.getBoundingClientRect();\n\t\tif (click.clientX - rect.left < rect.width / 2) {\n\t\t\tdirection = 0;\n\t\t} else {\n\t\t\tdirection = 1;\n\t\t}\n\t\ttrigger(action, direction);\n\t\tevent.preventDefault();\n\t}\n\tfunction initialize() {\n\t\tinputHandlers = {};\n\t\tvar board = $(\"#game-screen .game-board\")[0];\n\t\tdom.bind(board, \"mousedown\", function(event) {\n\t\t\thandleClick(event, \"CLICK\", event);\n\t\t});\n\t\tdom.bind(board, \"touchstart\", function(event) {\n\t\t\thandleClick(event, \"TOUCH\", event.targetTouches[0]);\n\t\t});\n\t\tdom.bind(document, \"keydown\", function(event) {\n\t\t\tvar keyName = keys[event.keyCode];\n\t\t\tif (keyName && settings.controls[keyName]) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\ttrigger(settings.controls[keyName]);\n\t\t\t}\n\t\t});\n\t}\n\tfunction bind(action, handler) {\n\t\t// Załącza działanie w grze do handlera.\n\t\tif (!inputHandlers[action]) {\n\t\t\tinputHandlers[action] = [];\n\t\t}\n\t\tinputHandlers[action].push(handler);\n\t}\n\tfunction trigger(action) {\n\t\t// Wyzwala działanie w grze.\n\t\tvar handlers = inputHandlers[action],\n\t\targs = Array.prototype.slice.call(arguments, 1);\n\t\tif (handlers) {\n\t\t\tfor (var i = 0; i < handlers.length; i++) {\n\t\t\t\thandlers[i].apply(null, args);\n\t\t\t}\n\t\t}\n\t}\n\treturn {\n\t\tinitialize : initialize,\n\t\tbind : bind\n\t};\n})();"]],"start1":0,"start2":0,"length1":0,"length2":1599}]],"length":1599}
{"contributors":[],"silentsave":true,"ts":1370791846124,"patch":[[{"diffs":[[0,"om.bind("],[-1,"board"],[1,"document"],[0,", \"touch"]],"start1":763,"start2":763,"length1":21,"length2":24}]],"length":1602,"saved":false}
