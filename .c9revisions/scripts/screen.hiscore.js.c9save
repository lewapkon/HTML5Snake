{"ts":1371231764488,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"snake.screens[\"hiscore\"] = (function() {\n\tvar dom = snake.dom,\n\t\t$ = dom.$,\n\t\tgame = snake.game,\n\t\tstorage = snake.storage,\n\t\tnumScores = 10,\n\t\tfirstRun = true;\n\tfunction setup() {\n\t\tvar backButton = $(\"#hiscore footer button[name=back]\")[0];\n\t\tdom.bind(backButton, \"click\", function(e) {\n\t\t\tgame.showScreen(\"main-menu\");\n\t\t});\n\t}\n\tfunction run(score) {\n\t\tif (firstRun) {\n\t\t\tsetup();\n\t\t\tfirstRun = false;\n\t\t}\n\t\tpopulateList();\n\t\tif (typeof score != \"undefined\") {\n\t\t\tenterScore(score);\n\t\t}\n\t}\n\tfunction populateList() {\n\t\tvar scores = getScores(),\n\t\t\tlist = $(\"#hiscore ol.score-list\")[0],\n\t\t\titem, nameEl, scoreEl, i;\n\t\t// Sprawdza czy lista jest pełna.\n\t\tfor (var i = scores.length; i < numScores; i++) {\n\t\t\tscores.push({\n\t\t\t\tname : \"---\",\n\t\t\t\tscore : 0\n\t\t\t});\n\t\t}\n\t\tlist.innerHTML = \"\";\n\t\tfor (i = 0; i < scores.length; i++) {\n\t\t\titem = document.createElement(\"li\");\n\t\t\tnameEl = document.createElement(\"span\");\n\t\t\tnameEl.innerHTML = scores[i].name;\n\t\t\tscoreEl = document.createElement(\"span\");\n\t\t\tscoreEl.innerHTML = scores[i].score;\n\t\t\titem.appendChild(nameEl);\n\t\t\titem.appendChild(scoreEl);\n\t\t\tlist.appendChild(item);\n\t\t}\n\t}\n\tfunction getScores() {\n\t\treturn storage.get(\"hiscore\") || [];\n\t}\n\tfunction enterScore(score) {\n\t\tvar scores = getScores(),\n\t\t\tname, i, entry;\n\t\tfor (i = 0; i <= scores.length; i++) {\n\t\t\tif (i == scores.length || score > scores[i].score) {\n\t\t\t\tname = prompt(\"Wpisz swoje imię: \");\n\t\t\t\tentry = {\n\t\t\t\t\tname : name,\n\t\t\t\t\tscore : score\n\t\t\t\t};\n\t\t\t\tscores.splice(i, 0, entry);\n\t\t\t\tstorage.set(\"hiscore\", scores.slice(0, numScores));\n\t\t\t\tpopulateList();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\treturn {\n\t\trun : run\n\t};\n})();"]],"start1":0,"start2":0,"length1":0,"length2":1632}]],"length":1632}
