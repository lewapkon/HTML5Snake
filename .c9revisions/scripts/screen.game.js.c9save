{"ts":1371063840421,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"snake.screens[\"game-screen\"] = (function() {\n\tvar settings = snake.settings,\n\t\tboard = snake.board,\n\t\tdisplay = snake.display,\n\t\tinput = snake.input,\n\t\tfirstRun = true,\n\t\ttimer, paused = false,\n\t\tstorage = snake.storage,\n\t\tdom = snake.dom,\n\t\t$ = dom.$;\n\tfunction run() {\n\t\tif (firstRun) {\n\t\t\tsetup();\n\t\t\tfirstRun = false;\n\t\t}\n\t\tstartGame();\n\t}\n\tfunction startGame() {\n\t\tvar activeGame = storage.get(\"activeGameData\"),\n\t\t\tuseActiveGame,\n\t\t\tdata;\n\t\tif (activeGame) {\n\t\t\tuseActiveGame = window.confirm(\"Czy chciałbyś powrócić do uprzednio zapisanej gry?\");\n\t\t\tif (useActiveGame) {\n\t\t\t\tboard.setBoard(activeGame.board);\n\t\t\t\tboard.setSnakes(activeGame.snakes);\n\t\t\t\tboard.setBonus(activeGame.bonus);\n\t\t\t\tboard.setScore(activeGame.score);\n\t\t\t\tboard.setTime(activeGame.time);\n\t\t\t\tboard.setRotation(activeGame.rotation);\n\t\t\t\tboard.setRotated(activeGame.rotated);\n\t\t\t\tboard.setCounter(activeGame.counter);\n\t\t\t}\n\t\t}\n\t\t\n\t\tboard.initialize(useActiveGame, function() {\n\t\t\tdisplay.initialize(function() {\n\t\t\t\ttimer = setInterval(board.go, 200);\n\t\t\t});\n\t\t});\n\t}\n\tfunction announce(str) {\n        var element = $(\"#game-screen .announcement\")[0];\n        element.innerHTML = str;\n        if (1 == 1) {\n            dom.removeClass(element, \"zoomfade\");\n            setTimeout(function() {\n                dom.addClass(element, \"zoomfade\");\n            }, 1);\n        } else {\n            dom.addClass(element, \"active\");\n            setTimeout(function() {\n                dom.removeClass(element, \"active\");\n            }, 1000);\n        }\n    }\n\tfunction gameOver() {\n\t\tstopGame();\n\t\tstorage.set(\"activeGameData\", null);\n\t\tdisplay.gameOver(function() {\n\t\t\t//announce(\"Przegrałeś grę!\");\n\t\t\tsetTimeout(function() {\n\t\t\t\tsnake.game.showScreen(\"hiscore\", board.getScore());\n\t\t\t}, 2500);\n\t\t});\n\t}\n\tfunction turn(turn) {\n\t\tif (turn == 0) {\n\t\t\tboard.turnLeft();\n\t\t}\n\t\tif (turn == 1) {\n\t\t\tboard.turnRight();\n\t\t}\n\t}\n\tfunction setup() {\n\t\tinput.initialize();\n\t\tinput.bind(\"turnLeft\", board.turnLeft);\n\t\tinput.bind(\"turnRight\", board.turnRight);\n\t\t//input.bind(\"go\", board.go);\n\t\tinput.bind(\"turn\", turn);\n\t\tdom.bind(\"#game-screen button[name=exit]\", \"click\", function() {\n\t\t\ttogglePause(true);\n\t\t\tvar exitGame = window.confirm(\"Czy chcesz powrócić do głównego menu?\");\n\t\t\ttogglePause(false);\n\t\t\tif (exitGame) {\n\t\t\t\tsaveGameData();\n\t\t\t\tstopGame();\n\t\t\t\tsnake.game.showScreen(\"main-menu\");\n\t\t\t}\n\t\t});\n\t}\n\tfunction stopGame() {\n\t\tclearInterval(timer);\n\t\ttimer = 0;\n\t}\n\tfunction togglePause(enable) {\n\t\tif (enable == paused) return;\n\t\tvar overlay =$(\"#game-screen .pause-overlay\")[0];\n\t\tpaused = enable;\n\t\toverlay.style.display = paused ? \"block\" : \"none\";\n\t\tif (paused) {\n\t\t\tclearInterval(timer);\n\t\t\ttimer = 0;\n\t\t} else {\n\t\t\ttimer = setInterval(board.go, 200);\n\t\t}\n\t}\n\tfunction saveGameData() {\n\t\tstorage.set(\"activeGameData\", {\n\t\t\tboard : board.getBoard(),\n\t\t\tsnakes : board.getSnakes(),\n\t\t\ttime : board.getTime(),\n\t\t\tcounter : board.getCounter(),\n\t\t\trotation : board.getRotation(),\n\t\t\trotated : board.getRotated(),\n\t\t\tbonus : board.getBonus(),\n\t\t\tscore : board.getScore()\n\t\t});\n\t}\n\treturn {\n\t\trun : run,\n\t\tgameOver : gameOver,\n\t\tannounce : announce,\n\t\tsaveGameData : saveGameData\n\t};\n})();"]],"start1":0,"start2":0,"length1":0,"length2":3161}]],"length":3161}
